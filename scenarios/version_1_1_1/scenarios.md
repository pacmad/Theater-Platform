# Сценарии (версия 1.1.1)
Изменения:
+ Добавлены сценарии функций "добавление и обновление фото"

## Блок "Пользователь" 
### Регистрация пользователя в системе

|    Пользовательский сценарий                    |    Функциональный сценарий    |
|-------------------------------------------------|-------------------------------|
|Предусловие: Пользователь на странице регистрации|Открыта страница регистрации|  
|1. Пользователь заполняет поля: фамилия, имя, отчество, дата рождения, номер телефона, e-mail, пароль, подтверждение пароля нажимает кнопку “Зарегистрироваться”| 1. Система получает данные: фамилия, имя, отчество, дата рождения, номер телефона, пароль, подтверждение пароля|
| *1.1 Если пользователь уже зарегистрирован, то он выбирает опцию Авторизации и переходит к сценарию “Авторизация пользователя в систему”*| *1.1 Если пользователь уже зарегистрирован, то он выбирает опцию Авторизации и переходит к сценарию “Авторизация пользователя в систему”*| 
| *1.2 Если пользователь ввел некорректные данные, то видит сообщение об ошибке*|2. Система выполняет проверку данных. Если данные введены некорректно, система выдает ошибку|
|2. Пользователь видит модальное окно “Мы отправили на вашу почту письмо. Пожалуйста, подтвердите регистрацию”|3. Если данные введены верно, система высылает на e-mail письмо с ссылкой для подтверждения регистрации|
|3.Пользователь открывает письмо в почтовом ящике и видит ссылку для подтверждения регистрации|4. Система отправляет пакет данных для отправки в БД|
|*3.1 Если ссылка была открыта через 30 минут после отправки письма, то пользователь видит ошибку "Ссылка просрочена. Пройдите регистрацию еще раз"*|*4.1 Если ссылка не активирована, то система удаляет пакет из БД*|
|4.Перейдя по ссылке, пользователь видит модальное окно с текстом “Регистрация прошла успешно”  |*4.2 Если ссылка активирована, то система сохраняет пакет в БД*|
|5.Пользователь видит раздел авторизации |5. Система открывает модальное окно с текстом “Регистрация прошла успешно”|
|**Итог:** Пользователь зарегистрирован в системе||

### Авторизация пользователя в системе

|    Пользовательский сценарий     |    Функциональный сценарий    |
|----------------------------------|-------------------------------|
|Предусловие: Пользователь на странице авторизации|Открыта страница авторизации|  
|1. Пользователь вводит e-mail и пароль, затем выбирает опцию входа в систему |1. Система получает e-mail и пароль|
|*1.1 Если пользователь еще не зарегистрирован, то переходит к сценарию “Регистрация пользователя в систему”*|2. Система выполняет проверку введенных данных|
|*1.2 Если пользователь ввел неверный логин или пароль, то видит сообщение об ошибке*|*2.1 Если пользователь ввел некорректные данные, то система выводит сообщение об ошибке*|
|2. Пользователь успешно авторизовался.| *2.2 Если данные введены верно, то база данных отправляет системе  id пользователя и данные*|
| |3. Система получает id пользователя и переходит в личный кабинет пользователя|
|**Итог:** Пользователь авторизовался в системе||

### Восстановление пароля

|    Пользовательский сценарий     |    Функциональный сценарий    |
|----------------------------------|-------------------------------|
|Предусловие: Пользователь на странице восстановление пароля|Открыта страница восстановление пароля| 
|1. Пользователь забыл/хочет изменить пароль. Нажимает на опцию "Восстановить пароль"|1. Система принимает запрос на восстановление пароля|
|2. Пользователь вводит e-mail и видит модальное окно с текстом “На вашу почту отправлено письмо для смены пароля”|2. Система создает одноразовую ссылку на 30 минут и формирует письмо|
|3. Пользователь открывает письмо в почтовом ящике и переходит по ссылке|3.Система считывает e-mail и отправляет на почту письмо с ссылкой для смены пароля|
|4. Пользователь видит поля: e-mail, пароль, подтверждение пароля |4. Система отображает поля: e-mail, пароль, подтверждение пароля|
|5. Пользователь выбирает сохранить и видит модальное окно “Новый пароль сохранен”|5.Система считывает данные и отправляет данные для сохранения в БД|
|*5.1 Если пользователь ввел некорректные данные, то видит сообщение об ошибке*|*5.1 Система выполняет проверку данных. Если данные введены некорректно, система выдает ошибку*|
|**Итог:** Пользователь сменил пароль||

## Блок "Личный кабинет"
### Добавление фото
*Требования к фото:  размер не менее 200x200px, соотношение сторон от 0.25 до 3, сумма высоты и ширины не более 14000px, файл объемом не более 50 МБ, соотношение сторон не менее 1:20*
|    Пользовательский сценарий                    |    Функциональный сценарий    |
|-------------------------------------------------|-------------------------------|
|Предусловие: Пользователь в личном кабинете|Предусловие: Открыта страница личного кабинета| 
|1. Пользователь выбирает опцию "Добавить фото" |1. Система принимает запрос на добавление фото|
|2. Появляется модальное окно с текстом "Вы можете загрузить изображение в формате JPG или PNG." и кнопка выбрать файл|2. Система открывает модальное окно с кнопкой для загрузки фото|
|3. Пользователь выбирает файл и выбирает открыть|3. Система делает проверку файла на соответствие с требованиями|
|*3.1 Если файл не соответствует требованиям, пользователь видит ошибку "Попробуйте выбрать фотографию меньшего размера."*|*3.1 Если файл не соответсвует требованиям, то система не загружает его в БД*|
|4. Происходит загрузка фото. Пользователь может выбрать область фото, которая будет отобрачаться в профиле|4. Если файл соответствует требованиям, то система загружает фото в БД с привязкой к id профиля|
|5. Пользователь выбирает "Сохранить", модальное окно закрывается, страница обновляется и фото отображается|5. Система закрывает модальное окно, обновляет страницу и тображает фото в личном кабинете|
|*5.1 Если пользователь хочет отменить загрузку фото, то может выбрать "Отмена" на любом этапе*||
|Итог: у пользователя в личном кабинете есть фотография||

### Обновление фото
*Требования к фото:  размер не менее 200x200px, соотношение сторон от 0.25 до 3, сумма высоты и ширины не более 14000px, файл объемом не более 50 МБ, соотношение сторон не менее 1:20*
|    Пользовательский сценарий                    |    Функциональный сценарий    |
|-------------------------------------------------|-------------------------------|
|Предусловие: У пользователь есть фото в личном кабинете|Предусловие: Открыта страница личного кабинета с фото пользователя| 
|1. Пользователь выбирает опцию "Обновить фото" |1. Система принимает запрос на обновление фотографии|
|2. Появляется модальное окно с текстом "Вы можете загрузить изображение в формате JPG или PNG." и кнопка выбрать файл|2. Система открывает модальное окно с кнопкой для загрузки фото|
|3. Пользователь выбирает файл и выбирает открыть|3. Система делает проверку файла на соответствие с требованиями|
|*3.1 Если файл не соответствует требованиям, пользователь видит ошибку "Попробуйте выбрать фотографию меньшего размера."*|*3.1 Если файл не соответсвует требованиям, то система не загружает его в БД*|
|4. Происходит загрузка фото и пользователь может выбрать область фото, которая будет отобрачаться в профиле|4. Если файл соответствует требованиям, то система загружает фото в БД с привязкой к id профиля. Старое фото удаляет из БД|
|5. Пользователь выбирает "Сохранить", модальное окно закрывается, страница обновляется и фото отображается|5. Система закрывает модальное окно, обновляет страницу и отображает новое фото в личном кабинете|
|*5.1 Если пользователь хочет отменить загрузку фото, то может выбрать "Отмена" на любом этапе*||
|Итог: у пользователя в личном кабинете новая фотография||

### Просмотр избранного
|    Пользовательский сценарий                    |    Функциональный сценарий    |
|-------------------------------------------------|-------------------------------|
|Предусловие: Пользователь в личном кабинете|Предусловие: Открыта страница личного кабинета|
|1. Пользователь переходит в раздел "Избранное"|1. Система проверяет наличие избранных спектаклей у пользователя и открывает страницу "Избранное"|
|2. Пользователь видит карточки спектаклей с красным сердечком в правом верхнем углу|2. Система отображает спектакли, привязанные к id пользователя со статусом "Избранное"|
|*2.1 Если избранных спектаклей нет, то есть кнопка "Добавить в избранное". При нажатии прользователь переходит в раздел "Афиши"*|*2.1 Если система не находит избранные спектакли, то открывает страницу с кнопкой, которая позволяет переходит на страницу "Афиши"*|
|3. Пользователь может удалять спектакли из избранного, нажав на красное сердце. После обновления страницы спектакль не будет отображаться в избранном.|3. Если спектаклю обозначается статус "не избранное", то система готовит его данные для удаления из избранного в БД|
|*3.1 До обновления страницы пользователь может вернуть спектакль в избранное, нажав на белое сердце*|*3.1 Если статус не был изменен на избранное, то при обновлении или переходе на другую страницу данные удаляются из БД*|
|*3.2 Если пользователь переходит в другой раздел в личном кабинете, то убранные из избранного спектакли удаляются*|*3.2 Если статус был изменен на "избранное", то система возвращает данные в исходное состояние в БД*|
|4. Пользователь через карточку спектакля может переходить на страницы: описание спектакля, отзывы, режиссер-постановщик, художник-постановщик, театр.|4. Система отображает карточки спектаклей с гиперссылками на страницы: описание спектакля, отзывы, режиссер-постановщик, художник-постановщик, театр.|
*Итог: пользователь может добавлять, удалять карточки спектаклей из раздела "Избранное". Может быстро переходить на определенные страницы.*

### Управление моими покупками/подтверждение билета
|    Пользовательский сценарий                    |    Функциональный сценарий    |
|-------------------------------------------------|-------------------------------|
|Предусловие: Пользователь в личном кабинете|Предусловие: Открыта страница личного кабинета|
|1. Пользователь переходит в раздел "Мои покупки"|1. Система проверяет наличие купленных билетов у пользователя и открывает страницу "Мои покупки"|
|2. Пользователь видит остортированный по дате и времени оплаты список билетов. Справа статус билета "Подтвердить код по e-mail" или "Подтвержден" |2. Система автоматически сортирует билеты по дате в обратном порядке. и отображает статус билета справа.|
|*2.1 Если купленных билетов нет, то появляется кнопка "Купить билет". Нажав на нее, пользователь окажется в разделе "Билеты"*|*2.1 Если купленных билетов нет, то система отображает кнопку "Купить билет"с ссылкой на раздел "Билеты"*|
|3. Пользователь нажимает кнопку "Подтвердить код по e-mail". Кнопка становится неактивной. Появляется модальное окно с текстом "На Ваш e-mail выслано письмо с кодом. Пожалуйста, проверьте почтовый ящик."|3. Система принимает запрос на подтверждение кода. Система генерирует шестизначный код привязывает его к id билета и отправляет письмо с кодом на e-mail|
|4. Пользователь открывает письмо с кодом. Возвращается на страницу с билетами. Закрывает модальное окно. Видит изменение статуса - неактивную кнопку "Подтвержден"|4. Система после отправки письма изменяет статус билета на "Подтвержден"|
|5. Пользователь может переходить на страницу спектакля по клику на название|5. Система позволяет переходить на страницу спектакля через его название|
*Итог: Пользователь может отслеживать статус билетов и подтверждать оплату билета*

### Уведомления
|    Пользовательский сценарий                    |    Функциональный сценарий    |
|-------------------------------------------------|-------------------------------|
|Предусловие: Пользователь авторизован. Находится на любой странице.|Предусловие: Пройдена авторизация. Открыта любая страница|
|1. ||
|||
|||
|||
|||
|||
|||
