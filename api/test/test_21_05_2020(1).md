# Test 21.05.2020

## Registration
### Предусловия группы тестов
```
request method = POST
route = http://host1813162.hostland.pro/api/register

Headers:  
    Key: Accept  
    Value: application/json   

Body(json):     
{
    "email": "{{email}}",
    "name": "Ivan",
    "middle_name": "Ivanovich",
    "password": "{{password}}",
    "password_confirmation": "{{password}}",
    "is_admin": false
}
```
### Баги несоответствия
#### "Ограничения на хранимые данные" упоминается отчество, но в API не передаются данные связанные с отчеством (Если это планы на будущее, то , может, это лучше как-то отметить в документе).

### Тесты
#### Регистрация с валидными данными(Успешно)
```
Предусловия: {{email}} = <Ранее незарегестрированный пользователь>
             {{password}} = 123123Qwe
             
Шаги: Послать API запрос на регистрацию 

Ожидаемый результат: Придёт json с
{
    "has_errors": false,
    "errors": [],
    "message": "Письмо для активации почты отправлено на ваш email адрес",
}

Фактический результат: Пришёл json с
{
    "has_errors": false,
    "errors": "[]",
    "message": "Письмо для активации почты отправлено на ваш email адрес"
}
```
#### Регистрация с невалидными данными(Баг со структурой json файла ошибки)
- ?? type ошибок в документах не указан нигде
```
Предусловия: {{email}} = <Ранее не зарегестрированный пользователь>
             {{password}} = 
             
Шаги: Послать API запрос на регистрацию 

Ожидаемый результат: Придёт json с
{
    "has_errors": true,
    "errors": [
        {
            "type": "WrongPassword",
            "message": "Слишком короткий пароль"
        }
    ],
    "message": "В процессе получения информации о пользователе возникли ошибки."
}

Фактический результат: Пришёл json с
{
    {
    "message": "The given data was invalid.",
    "errors": {
        "email": [
            "The email has already been taken."
        ],
        "password": [
            "The password field is required."
        ]
    }
}
```

#### При подтверждении регистрации по почте, происходит переход по ссылке, но появляется ошибка 404.
```
404|Not Found
```

## Authorization
### Предусловия группы тестов
```
Аккаунт уже был зарегестрирован, на почту пришло сообщение с подтверждением, но при попытке подтвердить и пройти по ссылке 
происходит ошибка. Аккаунт всё же создаётся. Он и используется. 

request method = POST
route = http://host1813162.hostland.pro/api/login

Headers:  
    Key: Accept  
    Value: application/json   

Body:     
json
{
    "email": "{{email}}",
    "password": "{{password}}"
}
```
#### Авторизация с валидными данными (Баг, структура json ответа не соответствует документации)
```
Предусловия: {{email}} = 3@gmail.com
             {{password}} = 123123Qwe
             
Шаги: Послать API запрос на авторизацию 

Ожидаемый результат: Придёт json с
{
    "has_errors": false,
    "errors": [],
    "token": "access_token_here",
    "user": {
        "id": <любое число int>,
        "email": "3@gmail.com",
        "name": "Иван",
        "middle_name": "Иванович",
        "is_admin": false
    }
}

Фактический результат: Пришёл json с
{
    "user": {
        "id": 23,
        "name": "Иван",
        "email": "3@gmail.com",
        "email_verified_at": null,
        "created_at": "2020-05-21T09:24:32.000000Z",
        "updated_at": "2020-05-21T09:24:32.000000Z"
    },
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxIiwianRpIjoiNzJiOWU0MTJjMDVjM2IzZDIwZjY4MjU0MDJlNDkxOTljZjI5NjczZWFmNTBlZjM4Y2U2YjJlYzQyYjMxMGY0MzRkYjFjZGUxMzI1NWQ4NWYiLCJpYXQiOjE1OTAwNTMyMzksIm5iZiI6MTU5MDA1MzIzOSwiZXhwIjoxNjIxNTg5MjM5LCJzdWIiOiIyMyIsInNjb3BlcyI6W119.le4d0erzIiaZgGj2MZUvS6LaCdkgSvCruhAD9LInnRcePBvsl-r4J8OTfMjWkL1a9pYYnjZQbLFJTSCY7xl4GxbZogkAI3ETiaQ6hNv6lxzyLmWC_5_gT_kN-pnK0xz-OV0wBFnh-1wU_fUqcRghV6lupWBa8LFaPX3eekUF1qMplxXNk0vJfRfyH-wNUotnhrC3FNUv6WDb4SSRC7pcTan7Bu9fxdFzyL6lOdCtTAKHrVtvh_GEkIO2wxqUK4sDDK5EJLiiu7ogW0D_9ZuQZnyVeBbdYpxoFrGZcCMyGouWe6eODFMzbyfNfksrzXNfqinitOQFPh4Jj7WxywdYLdl2HDdJ011mwdDyqX8kWmmSPnQQ41dK9w03uyfpCYmZTM38Zd3jJ1tiWmh_XbVjHwsj5i0FQyAwoYZbNXiE6NK2Z3PsgR0bKp2pW8fT6Sq5NvXNZQIvKmrH-TpRMrJdsQE1maJSZ22kmuxs-WbIrUb3atgwq6TSnhcP3TQfNpHdiADAh5VgE4BvQax0KlnQUD-hwneu-V36lwyXI8OADIX5VwuaAKN1-VPlLvtGZNg4uFVctTH1YwAOzfC85N_CvklDUSz8oPh1lyEmc55qlKs1SGtW6aO8cgTmLq4d8s_R78FFT4HhSLfMxPq-CvDReW1u4XAkEtEQ-nvFu09xGig"
}
```

#### Регистрация с невалидными данными(Баг, структура json ответа не соответствует документации)
```
Предусловия: {{email}} = <Ранее незарегестрированный пользователь>
             {{password}} = 123123Qwe
             
Шаги: Послать API запрос на регистрацию 

Ожидаемый результат: Придёт json с
{
    "has_errors": true,
    "errors": [
        {
            "type": "EmailError",
            "message": "Пользователь с таким адресом электронной почты не зарегистрирован"
        },       
        {
            "type": "EmailError",
            "message": "Чтобы авторизоваться необходимо подтвердить email адрес"
        },
        {
            "type": "PasswordError",
            "message": "Неверный пароль"
        }
    ],
    "token": null,
    "user": null
}

Фактический результат: Пришёл json с
{
    "message": "invalid data"
}
```
## Logout
### Предусловия группы тестов
```
request method = POST
route = http://host1813162.hostland.pro/api/logout

Headers:  
    Key: Accept  
    Value: application/json 
    
    Key: Authorization
    Value: <Активный токен, который можно получить при авторизации>
```
### Тесты
#### Выход(Logout) (Баг, при отправке запроса происходит ошибка на сервере)
- ?? json файл не прописан в документации
```
Предусловия: 
             
Шаги: Послать API запрос на авторизацию 

Ожидаемый результат: <Неизвестно>

Фактический результат: Пришёл json с
{
    "user": {
        "id": 23,
        "name": "Иван",
        "email": "3@gmail.com",
        "email_verified_at": null,
        "created_at": "2020-05-21T09:24:32.000000Z",
        "updated_at": "2020-05-21T09:24:32.000000Z"
    },
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxIiwianRpIjoiNzJiOWU0MTJjMDVjM2IzZDIwZjY4MjU0MDJlNDkxOTljZjI5NjczZWFmNTBlZjM4Y2U2YjJlYzQyYjMxMGY0MzRkYjFjZGUxMzI1NWQ4NWYiLCJpYXQiOjE1OTAwNTMyMzksIm5iZiI6MTU5MDA1MzIzOSwiZXhwIjoxNjIxNTg5MjM5LCJzdWIiOiIyMyIsInNjb3BlcyI6W119.le4d0erzIiaZgGj2MZUvS6LaCdkgSvCruhAD9LInnRcePBvsl-r4J8OTfMjWkL1a9pYYnjZQbLFJTSCY7xl4GxbZogkAI3ETiaQ6hNv6lxzyLmWC_5_gT_kN-pnK0xz-OV0wBFnh-1wU_fUqcRghV6lupWBa8LFaPX3eekUF1qMplxXNk0vJfRfyH-wNUotnhrC3FNUv6WDb4SSRC7pcTan7Bu9fxdFzyL6lOdCtTAKHrVtvh_GEkIO2wxqUK4sDDK5EJLiiu7ogW0D_9ZuQZnyVeBbdYpxoFrGZcCMyGouWe6eODFMzbyfNfksrzXNfqinitOQFPh4Jj7WxywdYLdl2HDdJ011mwdDyqX8kWmmSPnQQ41dK9w03uyfpCYmZTM38Zd3jJ1tiWmh_XbVjHwsj5i0FQyAwoYZbNXiE6NK2Z3PsgR0bKp2pW8fT6Sq5NvXNZQIvKmrH-TpRMrJdsQE1maJSZ22kmuxs-WbIrUb3atgwq6TSnhcP3TQfNpHdiADAh5VgE4BvQax0KlnQUD-hwneu-V36lwyXI8OADIX5VwuaAKN1-VPlLvtGZNg4uFVctTH1YwAOzfC85N_CvklDUSz8oPh1lyEmc55qlKs1SGtW6aO8cgTmLq4d8s_R78FFT4HhSLfMxPq-CvDReW1u4XAkEtEQ-nvFu09xGig"
}
```


